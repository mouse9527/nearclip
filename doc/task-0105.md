# Task 0105: 实现设备状态追踪

## 任务描述

实现设备状态追踪功能，实时监控设备的在线和连接状态。

## 正交性分析

- **状态监控**: 专注于设备状态变化
- **事件系统**: 状态变化事件通知
- **历史记录**: 状态变化历史追踪
- **健康检查**: 设备健康状态检测

## 技术实现

### 核心组件
```rust
// rust-core/discovery/status_tracker.rs
pub struct StatusTracker {
    device_statuses: HashMap<String, DeviceStatusHistory>,
    health_checker: HealthChecker,
    event_emitter: EventEmitter<DeviceStatusEvent>,
}

pub struct DeviceStatusHistory {
    pub current_status: DeviceStatus,
    pub status_changes: Vec<StatusChange>,
    pub last_health_check: SystemTime,
    pub health_score: f32,
}

pub struct DeviceStatusEvent {
    pub device_id: String,
    pub old_status: DeviceStatus,
    pub new_status: DeviceStatus,
    pub timestamp: SystemTime,
}
```

### 接口设计
```rust
impl StatusTracker {
    pub fn new() -> Self;
    pub async fn update_device_status(&mut self, device_id: &str, status: DeviceStatus);
    pub fn get_device_status(&self, device_id: &str) -> Option<&DeviceStatus>;
    pub fn get_device_health(&self, device_id: &str) -> Option<f32>;
    pub fn subscribe_to_status_changes(&mut self, callback: Box<dyn Fn(DeviceStatusEvent) + Send + Sync>);
    pub async fn perform_health_check(&mut self, device_id: &str);
}
```

## 验收标准

- [ ] 实时状态更新
- [ ] 健康检查机制
- [ ] 状态变化事件
- [ ] 历史记录管理
- [ ] 性能优化
- [ ] 可扩展的事件系统