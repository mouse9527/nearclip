# Story 001: 设备发现与连接

## 用户故事

**作为一个** NearClip 用户，  
**我希望** 能够自动发现附近的其他 NearClip 设备，  
**以便** 能够与它们建立连接并进行剪贴板同步。

## 验收标准

### 通用验收标准
- [ ] 应用能够自动发现网络中的其他 NearClip 设备
- [ ] 支持同时通过 WiFi 和 BLE 进行设备发现
- [ ] 发现的设备显示在用户界面中，包含设备名称和连接状态
- [ ] 用户可以选择设备进行连接
- [ ] 连接过程对用户透明，不显示底层传输方式
- [ ] 设备发现过程不消耗过多电量（<2%电池/小时）
- [ ] 发现响应时间 < 3秒
- [ ] 设备名称在不同设备间保持一致，确保A、B设备看到的C设备名称相同

### Android平台特定验收标准
- [ ] Android应用在后台和前台都能正常进行设备发现
- [ ] 适配Android Doze模式和App Standby的设备发现策略
- [ ] 在Android 10+上正确处理蓝牙和WiFi权限
- [ ] Android应用在锁屏状态下保持BLE扫描能力
- [ ] 适配不同Android版本的蓝牙和WiFi API
- [ ] Android通知系统正确显示设备发现状态
- [ ] 在Android低电量模式下智能降低扫描频率
- [ ] Android应用在多用户环境下正常工作

### macOS平台特定验收标准
- [ ] macOS应用在后台和前台都能正常进行设备发现
- [ ] 正确处理macOS系统休眠和唤醒后的设备重发现
- [ ] 适配macOS安全机制（网络访问、蓝牙权限）
- [ ] 在macOS菜单栏应用中显示设备发现状态
- [ ] 支持macOS多个桌面空间的设备发现一致性
- [ ] 适配不同macOS版本的网络和蓝牙API
- [ ] macOS应用在低电量模式下优化设备发现
- [ ] 支持macOS系统偏好设置中的网络配置变化

## 非功能性需求

### 性能要求
- **发现延迟**: < 3秒（首次）, < 1秒（后续）
- **内存占用**: < 10MB（发现服务）
- **CPU使用**: < 1%（空闲状态）, < 5%（发现过程中）
- **电池消耗**: < 2%/小时（后台运行）
- **网络带宽**: < 100KB/s（发现消息）

### 可靠性要求
- 设备名称在不同设备间保持一致性
- 发现成功率 > 95%
- 连接稳定性 > 99%

### 安全要求
- 发现过程中不传输敏感信息
- 验证设备标识的真实性
- 防止发现过程中的中间人攻击
- 支持设备黑名单机制

### 用户体验要求
- 设备名称支持多语言显示
- 状态消息和错误信息本地化
- 简洁直观的用户界面
- 清晰的设备状态指示
