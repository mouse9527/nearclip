# Task 0204: 实现PIN码配对

## 任务描述

实现基于PIN码的设备配对功能，作为二维码配对的备选方案。

## 正交性分析

- **PIN码生成**: 生成安全的配对码
- **验证逻辑**: PIN码验证机制
- **用户体验**: 简洁的输入流程
- **安全**: 防止暴力破解

## 技术实现

### 核心组件
```rust
// rust-core/pairing/pin_pairing.rs
pub struct PinPairingManager {
    key_exchange: EcdhKeyExchange,
    pin_generator: PinGenerator,
    pairing_sessions: HashMap<String, PinPairingSession>,
}

pub struct PinPairingSession {
    pub session_id: String,
    pub pin_code: String,
    pub public_key: PublicKey,
    pub created_at: SystemTime,
    pub expires_at: SystemTime,
    pub attempts: u32,
}

pub struct PinGenerator {
    pub length: u8,
    pub characters: String,
    pub expiration_duration: Duration,
    pub max_attempts: u32,
}
```

### 接口设计
```rust
impl PinPairingManager {
    pub fn new() -> Self;
    pub fn create_pairing_session(&mut self) -> Result<PinPairingSession, PairingError>;
    pub fn validate_pin_code(&mut self, session_id: &str, pin: &str, remote_public: &[u8]) -> Result<bool, PairingError>;
    pub fn get_session_info(&self, session_id: &str) -> Option<&PinPairingSession>;
    pub fn cleanup_expired_sessions(&mut self);
    pub fn cancel_session(&mut self, session_id: &str) -> bool;
}
```

## 验收标准

- [ ] 安全的PIN码生成
- [ ] 会话管理完善
- [ ] 防暴力破解机制
- [ ] 超时处理
- [ ] 错误提示清晰
- [ ] 配对成功率优化