syntax = "proto3";

package nearclip.sync;

// Sync data types
enum SyncDataType {
  SYNC_DATA_TYPE_UNSPECIFIED = 0;
  SYNC_DATA_TYPE_CLIPBOARD_TEXT = 1;
  SYNC_DATA_TYPE_CLIPBOARD_IMAGE = 2;
  SYNC_DATA_TYPE_CLIPBOARD_FILE = 3;
  SYNC_DATA_TYPE_NOTIFICATION = 4;
}

// Clipboard content
message ClipboardContent {
  SyncDataType data_type = 1;
  oneof content {
    TextContent text = 2;
    ImageContent image = 3;
    FileContent file = 4;
  }
  int64 timestamp = 5;
  string source_device_id = 6;
  map<string, string> metadata = 7;
}

// Text content
message TextContent {
  string text = 1;
  string mime_type = 2;
  int32 char_count = 3;
}

// Image content
message ImageContent {
  bytes image_data = 1;
  string mime_type = 2;
  int32 width = 3;
  int32 height = 4;
  int32 size_bytes = 5;
}

// File content
message FileContent {
  string file_name = 1;
  bytes file_data = 2;
  string mime_type = 3;
  int64 file_size = 4;
  string file_hash = 5;
}

// Sync request
message SyncRequest {
  string target_device_id = 1;
  repeated ClipboardContent contents = 2;
  bool require_confirmation = 3;
  int64 request_id = 4;
}

// Sync response
message SyncResponse {
  bool success = 1;
  string error_message = 2;
  int64 request_id = 3;
  SyncStatus status = 4;
}

// Sync status
enum SyncStatus {
  SYNC_STATUS_UNSPECIFIED = 0;
  SYNC_STATUS_PENDING = 1;
  SYNC_STATUS_IN_PROGRESS = 2;
  SYNC_STATUS_COMPLETED = 3;
  SYNC_STATUS_FAILED = 4;
  SYNC_STATUS_CANCELLED = 5;
}

// Sync history
message SyncHistory {
  repeated SyncEntry entries = 1;
}

message SyncEntry {
  int64 timestamp = 1;
  string source_device_id = 2;
  string target_device_id = 3;
  SyncDataType data_type = 4;
  SyncStatus status = 5;
  int64 sync_id = 6;
}
